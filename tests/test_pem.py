from ssh_key_mgr import pem

PEM_FILE = b"""-----BEGIN OPENSSH PRIVATE KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAxnQK+kSWEzmCkbPxKvSC0AiZRsiHHENKz48GZfYFGhoCwsfjupIQ
gpOCQwC/F4td0rm+ZFRkj5s/5xQxe21gy5ndEFILhbd9McmYCBuyx6CUb4JxZ/7tGAoBOF
ZmQyZC+YjCY53BnnI0gjjDCDZOoYyKdFS3QRyq8ekPNSV7G27niOgDZlrqdd7GYUNyt3vq
r7ysoN4GUNytxuTLH++pEPfntsLp1MklamFlrvDe96zGS/K+8y/iC1TNCs61HgYXtz46Ch
538/E3LOD9fBc3lzF80kqMieCZdAEk4kvs5TpNpBBlXJ/qFqmPtdrVr8brqyyyKSnjoNNW
LHo6uXjdi7Pn70KBTfQRiAeIcNYqaW0CBky+dndijidbYf6L2rk1XintEYmyQOr+rdgUzL
QigF/Egu+wif9KeVD5bnTvF3xAzYBox3O70P43XH8bx5xgoaRRh2BAD3ffsdHPBflQEFHz
Qb2QdtQTGfVeUz9/5FH9IFvvqITxAypgli8WvQ55AAAFgNd//r7Xf/6+AAAAB3NzaC1yc2
EAAAGBAMZ0CvpElhM5gpGz8Sr0gtAImUbIhxxDSs+PBmX2BRoaAsLH47qSEIKTgkMAvxeL
XdK5vmRUZI+bP+cUMXttYMuZ3RBSC4W3fTHJmAgbsseglG+CcWf+7RgKAThWZkMmQvmIwm
OdwZ5yNII4wwg2TqGMinRUt0EcqvHpDzUlextu54joA2Za6nXexmFDcrd76q+8rKDeBlDc
rcbkyx/vqRD357bC6dTJJWphZa7w3vesxkvyvvMv4gtUzQrOtR4GF7c+Ogoed/PxNyzg/X
wXN5cxfNJKjIngmXQBJOJL7OU6TaQQZVyf6hapj7Xa1a/G66sssikp46DTVix6Orl43Yuz
5+9CgU30EYgHiHDWKmltAgZMvnZ3Yo4nW2H+i9q5NV4p7RGJskDq/q3YFMy0IoBfxILvsI
n/SnlQ+W507xd8QM2AaMdzu9D+N1x/G8ecYKGkUYdgQA9337HRzwX5UBBR80G9kHbUExn1
XlM/f+RR/SBb76iE8QMqYJYvFr0OeQAAAAMBAAEAAAGADHxs2+Pwks9ToB3zkqWtbNAbr7
TKbmxr8qzvpL7iwYqJKa7orLqHrCWChLtxanZv7eQWnuqh5Jiqn7v5JIhEVq8MtfwJgk1i
BL3HsVvnxtBbQnxRLQ9ApNptSvmBp+Aqhtd0To70iYbrN5XBbJz5G8gzRmA1ovS+KygEF0
6PRTG4QtiBLUGTXpzoe6JiH3n+ETZEYL8zY8dMrjbDMnRSXXFRjIHNM0CAGIY9/vCkAK6H
z+u7GKMmvFqGp5NLmTLeEtWzSRXeBAHpX5HdCGBOGBc+ReBeDS6OmHszirh5k4/u9e3MJd
9kclGIh0yKmWVnWPPbHebyNZdKPpTFL5bzc5T7PvbgpkWPaivNhZaTTGqlPlzg8ld+ZDE+
XGzskRTMUGx95uVS1gd8Y2NNc9dGIXQywk04W7dC7XK/9CISA34imySMWqBLnyyzkLVd+B
KHn4SDgsq+aPZes8Ag5oNBu5VvSBWhiSPEORzAyYEQ7RTQF5InZdaVWFcxpltmrNNRAAAA
wQCwtvYcWMTvXhHXInlZHUyPLOTE9NdgI3sSYtNK59ZY1wJZ3JwX0EqpQPJyoTByaAOzjD
MUMuHX2pVnSWwQduGE04FW0zljOFtGVm1haMwDa/4YfGeeDy5b8EtTXrmAe/Y+HV89pjjl
xbeU0EkAkMc5AhcKeGRebdgFNC2r+/4bJ58seJevtukCGiFolt+jLK5r1cohLYNCu7Ju7y
uIAeb1iPkZZS3ru03jvXNDTVZ172GN6x5RLMZ/0JVj0VOOBpMAAADBAPu+QcqIPG5Cx8QC
2EZ/CgaDr+y6JRSuZumbgO4oxO4t9mZvG8vK0Dg3Hu2qdN4JnU8Hf3Tb/VKyGb1UVpAEZu
nrErzXNJxxYRF8YZLgH7z07Eno1KDHTrpyD1ZnDHkWDLgEbCfAQoeLTNxTJ1q3m01lPM8u
IWS+X25C+tBZeknLxrKgwLi2IjxLGzALfmjqZTIyxTu3nDg3ewfPm4pcsADMrC8lwXMWOp
aXy3U7AHoa/jnFQl/aJkuS6ewSULXK8QAAAMEAyc8a7a3tXWiA9yD1Qc3iJ16UnfCz2bR/
Kq6mqr51f8w2l7ERVlCTgPa07kYZSSD96Bh/UxU7edCBMZEEmjFivUrXg1LmncUb1yBsYs
NFWjO8HZemXZiAbumXt2rzuICzR2iyvFeU0EVeLqKPTMSVXxXNohwVtA6stlgXaY76zWqQ
JLhXX/4xGe/6MgcoGFBrO2hjgoymf2g16BS1ZxFClAPokflEWKm3JmMJIY9JEtSuVkmhms
acMGoeZk/176wJAAAABmZkc2ZkcwECAwQ=
-----END OPENSSH PRIVATE KEY-----"""


def test_unmarshal_openssh_private_key():
    assert pem.unmarshal(PEM_FILE) == [
        pem.PEMBlock(
            header="OPENSSH PRIVATE KEY",
            footer="OPENSSH PRIVATE KEY",
            data=b"openssh-key-v1\x00\x00\x00\x00\x04none\x00\x00\x00\x04none\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x01\x97\x00\x00\x00\x07ssh-rsa\x00\x00\x00\x03\x01\x00\x01\x00\x00\x01\x81\x00\xc6t\n\xfaD\x96\x139\x82\x91\xb3\xf1*\xf4\x82\xd0\x08\x99F\xc8\x87\x1cCJ\xcf\x8f\x06e\xf6\x05\x1a\x1a\x02\xc2\xc7\xe3\xba\x92\x10\x82\x93\x82C\x00\xbf\x17\x8b]\xd2\xb9\xbedTd\x8f\x9b?\xe7\x141{m`\xcb\x99\xdd\x10R\x0b\x85\xb7}1\xc9\x98\x08\x1b\xb2\xc7\xa0\x94o\x82qg\xfe\xed\x18\n\x018VfC&B\xf9\x88\xc2c\x9d\xc1\x9er4\x828\xc3\x086N\xa1\x8c\x8atT\xb7A\x1c\xaa\xf1\xe9\x0f5%{\x1bn\xe7\x88\xe8\x03fZ\xeau\xde\xc6aCr\xb7{\xea\xaf\xbc\xac\xa0\xde\x06P\xdc\xad\xc6\xe4\xcb\x1f\xef\xa9\x10\xf7\xe7\xb6\xc2\xe9\xd4\xc9%jae\xae\xf0\xde\xf7\xac\xc6K\xf2\xbe\xf3/\xe2\x0bT\xcd\n\xce\xb5\x1e\x06\x17\xb7>:\n\x1ew\xf3\xf17,\xe0\xfd|\x177\x971|\xd2J\x8c\x89\xe0\x99t\x01$\xe2K\xec\xe5:M\xa4\x10e\\\x9f\xea\x16\xa9\x8f\xb5\xda\xd5\xaf\xc6\xeb\xab,\xb2))\xe3\xa0\xd3V,z:\xb9x\xdd\x8b\xb3\xe7\xefB\x81M\xf4\x11\x88\x07\x88p\xd6*im\x02\x06L\xbevwb\x8e'[a\xfe\x8b\xda\xb95^)\xed\x11\x89\xb2@\xea\xfe\xad\xd8\x14\xcc\xb4\"\x80_\xc4\x82\xef\xb0\x89\xffJyP\xf9nt\xef\x17|@\xcd\x80h\xc7s\xbb\xd0\xfe7\\\x7f\x1b\xc7\x9c`\xa1\xa4Q\x87`@\x0fw\xdf\xb1\xd1\xcf\x05\xf9P\x10Q\xf3A\xbd\x90v\xd4\x13\x19\xf5^S?\x7f\xe4Q\xfd [\xef\xa8\x84\xf1\x03*`\x96/\x16\xbd\x0ey\x00\x00\x05\x80\xd7\x7f\xfe\xbe\xd7\x7f\xfe\xbe\x00\x00\x00\x07ssh-rsa\x00\x00\x01\x81\x00\xc6t\n\xfaD\x96\x139\x82\x91\xb3\xf1*\xf4\x82\xd0\x08\x99F\xc8\x87\x1cCJ\xcf\x8f\x06e\xf6\x05\x1a\x1a\x02\xc2\xc7\xe3\xba\x92\x10\x82\x93\x82C\x00\xbf\x17\x8b]\xd2\xb9\xbedTd\x8f\x9b?\xe7\x141{m`\xcb\x99\xdd\x10R\x0b\x85\xb7}1\xc9\x98\x08\x1b\xb2\xc7\xa0\x94o\x82qg\xfe\xed\x18\n\x018VfC&B\xf9\x88\xc2c\x9d\xc1\x9er4\x828\xc3\x086N\xa1\x8c\x8atT\xb7A\x1c\xaa\xf1\xe9\x0f5%{\x1bn\xe7\x88\xe8\x03fZ\xeau\xde\xc6aCr\xb7{\xea\xaf\xbc\xac\xa0\xde\x06P\xdc\xad\xc6\xe4\xcb\x1f\xef\xa9\x10\xf7\xe7\xb6\xc2\xe9\xd4\xc9%jae\xae\xf0\xde\xf7\xac\xc6K\xf2\xbe\xf3/\xe2\x0bT\xcd\n\xce\xb5\x1e\x06\x17\xb7>:\n\x1ew\xf3\xf17,\xe0\xfd|\x177\x971|\xd2J\x8c\x89\xe0\x99t\x01$\xe2K\xec\xe5:M\xa4\x10e\\\x9f\xea\x16\xa9\x8f\xb5\xda\xd5\xaf\xc6\xeb\xab,\xb2))\xe3\xa0\xd3V,z:\xb9x\xdd\x8b\xb3\xe7\xefB\x81M\xf4\x11\x88\x07\x88p\xd6*im\x02\x06L\xbevwb\x8e'[a\xfe\x8b\xda\xb95^)\xed\x11\x89\xb2@\xea\xfe\xad\xd8\x14\xcc\xb4\"\x80_\xc4\x82\xef\xb0\x89\xffJyP\xf9nt\xef\x17|@\xcd\x80h\xc7s\xbb\xd0\xfe7\\\x7f\x1b\xc7\x9c`\xa1\xa4Q\x87`@\x0fw\xdf\xb1\xd1\xcf\x05\xf9P\x10Q\xf3A\xbd\x90v\xd4\x13\x19\xf5^S?\x7f\xe4Q\xfd [\xef\xa8\x84\xf1\x03*`\x96/\x16\xbd\x0ey\x00\x00\x00\x03\x01\x00\x01\x00\x00\x01\x80\x0c|l\xdb\xe3\xf0\x92\xcfS\xa0\x1d\xf3\x92\xa5\xadl\xd0\x1b\xaf\xb4\xcanlk\xf2\xac\xef\xa4\xbe\xe2\xc1\x8a\x89)\xae\xe8\xac\xba\x87\xac%\x82\x84\xbbqjvo\xed\xe4\x16\x9e\xea\xa1\xe4\x98\xaa\x9f\xbb\xf9$\x88DV\xaf\x0c\xb5\xfc\t\x82Mb\x04\xbd\xc7\xb1[\xe7\xc6\xd0[B|Q-\x0f@\xa4\xdamJ\xf9\x81\xa7\xe0*\x86\xd7tN\x8e\xf4\x89\x86\xeb7\x95\xc1l\x9c\xf9\x1b\xc83F`5\xa2\xf4\xbe+(\x04\x17N\x8fE1\xb8B\xd8\x81-A\x93^\x9c\xe8{\xa2b\x1fy\xfe\x116D`\xbf3c\xc7L\xae6\xc32tR]qQ\x8c\x81\xcd3@\x80\x18\x86=\xfe\xf0\xa4\x00\xae\x87\xcf\xeb\xbb\x18\xa3&\xbcZ\x86\xa7\x93K\x992\xde\x12\xd5\xb3I\x15\xde\x04\x01\xe9_\x91\xdd\x08`N\x18\x17>E\xe0^\r.\x8e\x98{3\x8a\xb8y\x93\x8f\xee\xf5\xed\xcc%\xdfdrQ\x88\x87L\x8a\x99egX\xf3\xdb\x1d\xe6\xf25\x97J>\x94\xc5/\x96\xf3s\x94\xfb>\xf6\xe0\xa6E\x8fj+\xcd\x85\x96\x93Lj\xa5>\\\xe0\xf2W~d1>\\l\xec\x91\x14\xccPl}\xe6\xe5R\xd6\x07|ccMs\xd7F!t2\xc2M8[\xb7B\xedr\xbf\xf4\"\x12\x03~\"\x9b$\x8cZ\xa0K\x9f,\xb3\x90\xb5]\xf8\x12\x87\x9f\x84\x83\x82\xca\xbeh\xf6^\xb3\xc0 \xe6\x83A\xbb\x95oH\x15\xa1\x89#\xc49\x1c\xc0\xc9\x81\x10\xed\x14\xd0\x17\x92'e\xd6\x95XW1\xa6[f\xac\xd3Q\x00\x00\x00\xc1\x00\xb0\xb6\xf6\x1cX\xc4\xef^\x11\xd7\"yY\x1dL\x8f,\xe4\xc4\xf4\xd7`#{\x12b\xd3J\xe7\xd6X\xd7\x02Y\xdc\x9c\x17\xd0J\xa9@\xf2r\xa10rh\x03\xb3\x8c3\x142\xe1\xd7\xda\x95gIl\x10v\xe1\x84\xd3\x81V\xd39c8[FVmah\xcc\x03k\xfe\x18|g\x9e\x0f.[\xf0KS^\xb9\x80{\xf6>\x1d_=\xa68\xe5\xc5\xb7\x94\xd0I\x00\x90\xc79\x02\x17\nxd^m\xd8\x054-\xab\xfb\xfe\x1b'\x9f,x\x97\xaf\xb6\xe9\x02\x1a!h\x96\xdf\xa3,\xaek\xd5\xca!-\x83B\xbb\xb2n\xef+\x88\x01\xe6\xf5\x88\xf9\x19e-\xeb\xbbM\xe3\xbdsCMVu\xefa\x8d\xeb\x1eQ,\xc6\x7f\xd0\x95c\xd1S\x8e\x06\x93\x00\x00\x00\xc1\x00\xfb\xbeA\xca\x88<nB\xc7\xc4\x02\xd8F\x7f\n\x06\x83\xaf\xec\xba%\x14\xaef\xe9\x9b\x80\xee(\xc4\xee-\xf6fo\x1b\xcb\xca\xd087\x1e\xed\xaat\xde\t\x9dO\x07\x7ft\xdb\xfdR\xb2\x19\xbdTV\x90\x04f\xe9\xeb\x12\xbc\xd74\x9cqa\x11|a\x92\xe0\x1f\xbc\xf4\xecI\xe8\xd4\xa0\xc7N\xbar\x0fVg\x0cy\x16\x0c\xb8\x04l'\xc0B\x87\x8bL\xdcS'Z\xb7\x9bMe<\xcf.!d\xbe_nB\xfa\xd0YzI\xcb\xc6\xb2\xa0\xc0\xb8\xb6\"<K\x1b0\x0b~h\xeae22\xc5;\xb7\x9c87{\x07\xcf\x9b\x8a\\\xb0\x00\xcc\xac/%\xc1s\x16:\x96\x97\xcbu;\x00z\x1a\xfe9\xc5B_\xda&K\x92\xe9\xec\x12P\xb5\xca\xf1\x00\x00\x00\xc1\x00\xc9\xcf\x1a\xed\xad\xed]h\x80\xf7 \xf5A\xcd\xe2'^\x94\x9d\xf0\xb3\xd9\xb4\x7f*\xae\xa6\xaa\xbeu\x7f\xcc6\x97\xb1\x11VP\x93\x80\xf6\xb4\xeeF\x19I \xfd\xe8\x18\x7fS\x15;y\xd0\x811\x91\x04\x9a1b\xbdJ\xd7\x83R\xe6\x9d\xc5\x1b\xd7 lb\xc3EZ3\xbc\x1d\x97\xa6]\x98\x80n\xe9\x97\xb7j\xf3\xb8\x80\xb3Gh\xb2\xbcW\x94\xd0E^.\xa2\x8fL\xc4\x95_\x15\xcd\xa2\x1c\x15\xb4\x0e\xac\xb6X\x17i\x8e\xfa\xcdj\x90$\xb8W_\xfe1\x19\xef\xfa2\x07(\x18Pk;hc\x82\x8c\xa6\x7fh5\xe8\x14\xb5g\x11B\x94\x03\xe8\x91\xf9DX\xa9\xb7&c\t!\x8fI\x12\xd4\xaeVI\xa1\x9a\xc6\x9c0j\x1efO\xf5\xef\xac\t\x00\x00\x00\x06fdsfds\x01\x02\x03\x04",
        ),
    ]
